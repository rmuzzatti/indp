---
title: "indp"
output: html_document
date: "2025-02-12"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(patchclampplotteR)
library(dplyr)
```

Cell Characteristics (all)
```{r}
cell_characteristics <- import_cell_characteristics_df("data/Cell-Characteristics.csv")

cell_characteristics
```

Raw evoked current data (RM)
```{r}
raw_eEPSC_df <- read.csv("data/rraw-eEPSC.csv")
```

To automatically append new data onto your existing sheet and save as new csv to data subfolder
```{r eval=FALSE}
add_new_cells(
  new_raw_data_csv = "data/RM/RMData.csv",
  cell_characteristics_csv = "data/Cell-Characteristics.csv",
  old_raw_data_csv = "data/rraw-eEPSC.csv",
  data_type = "eEPSC",
  write_new_csv = "yes",
  new_file_name = "data/rraw-eEPSC.csv",
  decimal_places = 2
)
```

```{r}
raw_eEPSC_df %>%
  filter(category == 5) %>%
  filter(time == 0) %>%
 group_by(treatment) %>%
  count(sex) %>%
  arrange(treatment, sex)
```
```{r eval=FALSE}
add_new_cells(
  new_raw_data_csv = "data/Raw-eEPSC-naive.csv",
  cell_characteristics_csv = "data/Cell-Characteristics.csv",
  old_raw_data_csv = "data/rraw-eEPSC.csv",
  data_type = "eEPSC",
  write_new_csv = "yes",
  new_file_name = "data/rraw-eEPSC.csv",
  decimal_places = 2
)
```

```{r}
my_theme_colours <- data.frame(
  category = c(1, 5),
    treatment = c("Cold", "Control"),
  display_names = c("Cold", "Control"),
  colours = c("#eb647e", "#005b96"),
  very_pale_colours = c("#f19cac", "#6497b1")
)
```

```{r}
raw_eEPSC_df <- make_normalized_EPSC_data(
  filename = "data/rraw-eEPSC.csv",
  current_type = "eEPSC",
  min_time_value = 0,
  max_time_value = 25,
  interval_length = 5,
  baseline_length = 5,
  negative_transform_currents = "yes"
)
```

```{r}
raw_eEPSC_control_plots <- plot_raw_current_data(
  data = raw_eEPSC_df,
  plot_treatment = "Control",
  plot_category = 5,
  current_type = "eEPSC",
  y_variable = "P1",
  pruned = "no",
  hormone_added = "HFS",
  hormone_or_HFS_start_time = 5,
  theme_options = sample_theme_options,
  treatment_colour_theme = sample_treatment_names_and_colours,
  save_plot_png = "no"
)
```

```{r}
pruned_eEPSC_df <- make_pruned_EPSC_data(
  data = raw_eEPSC_df,
  current_type = "eEPSC",
  min_time_value = 0,
  max_time_value = 25,
  baseline_length = 5,
  interval_length = 1
)
```

```{r}
pruned_eEPSC_control_plots <- plot_raw_current_data(
  data = sample_pruned_eEPSC_df$individual_cells,
  plot_treatment = "Control",
  plot_category = 5,
  current_type = "eEPSC",
  y_variable = "mean_P1",
  pruned = "yes",
  hormone_added = "HFS",
  hormone_or_HFS_start_time = 5,
  theme_options = sample_theme_options,
  treatment_colour_theme = sample_treatment_names_and_colours
)
```

